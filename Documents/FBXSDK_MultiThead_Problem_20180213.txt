FBX SDKとマルチスレッド
2018/02/13

FBX SDKをマルチスレッドで利用することについて
オートデスクの公式のドキュメントにも「保証はしない」と書いてある。
複数のFBXを続けて読み込む場合に謎のエラーが出て苦しんだが解決したようなのでそのことを書く。

ちなみにこの文書内容も保証はしない。
こちらではこれで解決したというメモ程度の位置づけである。

FbxObjectにconst char* GetName()という関数がある。
ドキュメントにはヌルターミネートの文字列のポインタを返すと書いてある。
このポインタの参照先に有効期限があるような症状が出た。
推測するに、SDKとしては実データのポインタではなくコピーデータへのポインタを返す場合がある。
そのコピーが永続的な有効期間を持っているわけではないように思う。
特にこのGetName()に関して。


それを踏まえて
アプリケーションでGetName()で得たポインタを保持して使いまわすことをやめて
使用するたびにGetName()を呼び出す、
もしくは
GetName()するときにアプリケーション側の配列にコピーして使用する
という方法を取った。

この方法により
複数のFBXを続けて読み込んでもエラー終了しなくなった。

そしてメモとしてこれをドキュメントにした。

以上。

化け猫おちゃっこ

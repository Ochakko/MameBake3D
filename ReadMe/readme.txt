このソフトの著作権はおちゃっこにあります。
ライセンスはLGPLです。

このプログラムは外部のライブラリを使用しています。
DirectX9.0c(マイクロソフトの3D描画ライブラリ)
OpenGL(３Ｄ描画ライブラリ(このプログラムではbulletからリンクされている))
bullet(オープンソースの物理演算ライブラリ)
FBX SDK 2013.3(Autodeskの互換用ファイル操作SDK)

ソリューションファイルは
VisualStudio 2013 Professionalで作りました。
ソリューションは2013用です。
VCランタイムは2010を使用しています。


######メタセコイアのFBX読み込み########
メタセコイアでFBX出力する場合は
出力する前に面の三角化を実行してください。

メタセコイアでボーンを入れたらボーンダイアログでポーズ出力メニューを実行してください。

メタセコイアのFBX出力オプションで
スムージンググループをオフにし
バージョンは２０１３にしてください。


＃＃＃
2016/04/07 
	法線をスムージングしてあるデータを読み込んだ場合のFBX書き出しをスムージングに対応させました。
	bvh用のFBXサンプルは準備中です。

2016/02/15 19:00頃のバージョン
	BVH2FBXで作成したデータをMakeBake3Dで読み込むことが出来、分岐ボーンも改善された。
	そのことに起因するかは調べ切れていないが
	ボーンのリストの選択と３Dのマニピュレータの選択がずれるようになっているのに気が付いた。
	以降のバージョンで修正予定である。

2016/02/15 19:50
	ボーンのリストとマニピュレータのずれは直った。
	BVH2FBXメニュー実行時の書き出し時に大きすぎる変化をカットするフィルターが付いているのであるが
	データによって可変であるべきことが分かった。
	以降のバージョンで修正予定である。

2016/02/16 19:00頃のバージョン
	分岐処理見直しと修正。
	bvhの回転順序の適用。
	ルートの回転移動修正。
	バインドポーズ修正。
	回転順序変換部分追加。
	Siteという同一名によるリスト選択のバグを修正。

2016/02/17 01:10頃のバージョン
	回転順序　再調整。
	bvh rotation filterの改良。
	BVH2FBXのダイアログにフィルター角度エディット欄を追加。

2016/02/17 09:45頃のバージョン
	BVH2FBXのオイラー角を抜本的に修正。
		再現率がかなりあがりました。
	
2016/02/17 11:20頃のバージョン
	複数のFBXを読み込んだ時のボーン表示のための機能を追加。
		複数読み込んだ後にCtrl + Aを押すと、読み込みモデルすべてのボーンを表示します。
		Ctrl + Aを押すたびにオンオフを切り替えます。
		普段はModelメニューで選択したモデルにしかボーンは表示されません。
		Ctrl + Aが有効の時には一番親からのボーンは表示されません。

2016/03/13
	モデルのFBXにモーションのFBXを適用する機能の追加。
	モデルとモーションとのボーン構造が多少異なっていても対応できます。

	モデルのボーンの位置にモーションのボーンの位置を合わせるような手作業は必要ありません。
	（初期姿勢が同じ必要はあります。例えばT字型の姿勢であるとか。）

	使い方の説明動画は
		https://youtu.be/ERaqn16GsU0



/////////// 以下、説明動画

MameBake3Dの使い方。ベイクの話。
ベイク済とは。ベイク済モーションの編集方法について。
https://youtu.be/Z0UacTlXs7w


MameBake3D説明動画。モデルFBXにモーションFBXを適用する話。
https://youtu.be/ERaqn16GsU0


MameBake3Dの使い方。BVHからFBXへの変換の話。
オイラー角出力を抜本的に見直した結果、モーション再現率がかなり上昇しました。
perfumeの３人が踊る動画。
https://youtu.be/ONnB1jDVi6k


MameBake3Dの使い方。
(MameBake3DでbvhをFBXにしてMayaでモデルにバインドして
再びMameBake3Dで読み込み、アニメーションを修正するまでの説明動画)
http://youtu.be/EjGnHuXPZm0


MameBake3Dでの物理の設定の仕方。
http://youtu.be/56kIA5OsZ0M

///////////////////
サンプルについて
2016/03/30

Mediaフォルダの中にtest10を入れました。
test10.chaをオープンすると全部読み込まれます。
モーションの選択で「For_F9_Test」という名前のモーションを選んでから
F9を押すと物理シミュレートが動きツインテールが揺れます。
F10を押すと同じく物理でラグドールします。
バグが取れてきているので以前よりはかなり扱いやすくなっています。

2016/03/31

test10の中のfbxファイルのボーンはメタセコイアのBVHテンプレートの階層を少しいじって使用したものです。
先ほど気が付いたのですが、一般的なBVHと比べて足りないボーンがあるようです。
現在のmain.cppのConvBoneRotation関数は、モデル側のボーンがbvh側よりも多い時にはうまくいきますが
モデル側のボーンの方が少ない時にはうまくいきません。
モデルデータのアップデートをする予定ですが、少し時間がかかるかもしれません。
古いfbxもgitには含まれているはずですので、そちらで試してもらうのも良いかもしれません。


2016/04/08 18:30

bvhの適用がうまくいくものとうまくいかないものがありました。
うまくいかない原因は上記では、ボーンが足りないせいだということにしていました。
しかし、その後の調査でbvhの最初のフレームにもモーションが記述してある場合があることがわかりました。
つまり、初期姿勢が想定していたものと異なっていたのです。
（最初のフレームの姿勢は足を平行にしていたが、モーションを削除してみたら足は大の字だった。）
次の更新はこの辺の変換をしてみようと思います。

